---
layout: archive
permalink: /report_fr/
title: "Rapport"
sidebar:
 nav: "report_fr"
---
<h2 id='commandes'>Commandes</h2>

<p>Ensemble de commandes de script permettant de construire des rapports. Il y a trois façons d'exécuter 
	un rapport :
</p>
<ul>
	<li>avec la ressource Tableau de bord dans un portfolio,</li>
	<li>dans la page Exécuter un rapport en spécifiant le nom du rapport,</li>
	<li>dans la page Exécuter un rapport en téléversant un fichier CSV (format: voir section Batch). 
		Dans le fichier CSV, les 2 premières lignes de variables globales ne sont pas prises en compte.</li>
</ul>


<p>Les commandes disponibles sont :</p>
<ul>
	<li><code><a href='#for-each-portfolio'>ForEachPortfolio</a></code></li>
	<li><code><a href='#for-each-portfolio-node'>ForEachPortfolioNode</a></code></li>
	<li><code><a href='#for-each-person'>ForEachPerson</a></code></li>
	<li><code><a href='#for-each-node'>ForEachNode</a></code></li>
	<li><code><a href='#for-each-line'>ForEachLine</a></code></li>
	<li><code><a href='#table'>Table</a></code></li>
	<li><code><a href='#row'>Row</a></code></li>
	<li><code><a href='#cell'>Cell</a></code></li>
	<li><code><a href='#node'>Node</a></code></li>
	<li><code><a href='#aggregate'>Aggregate</a></code></li>
	<li><code><a href='#text'>Text</a></code></li>
	<li><code><a href='#url2unit'>URL2Unit</a></code></li>
	<li><code><a href='#svg'>SVG</a></code></li>
	<li><code><a href='#draw-web-tile'>Draw Web Title</a></code></li>
	<li><code><a href='#draw-web-axis'>Draw Web Axis</a></code></li>
	<li><code><a href='#draw-web-line'>Draw Web Line</a></code></li>
	<li><code><a href='#show-sharing'>Show Sharing</a></code></li>
	<li><code><a href='#go-parent'>Go Parent</a></code></li>
	<li><code><a href='#qrcode'>QR Code</a></code></li>
</ul>



<article>
	<h3 id='for-each-portfolio'>ForEachPortfolio</h3>
	<p>Pour chacun des portfolios répondant au test de la sélection, Karuta exécute les commandes qui 
		se trouvent dans le <code>ForEachPortfolio</code>.
	</p>
	<p>Champs à renseigner&nbsp;:</p>
	<ul>
		<li>
			<code>Références à initialiser</code> Liste des variables (séparées par une barre oblique) à 
			réinitialiser pour chaque nouveau portfolio.
		</li>
		<li>
			<code>Sélection portfolios</code> Test Jquery permetant de sélectionner des portfolios parmi 
			ceux visibles par l'usager.
			<br/>Exemples :
			<ul>
				<li><code>code*='2015_work'</code> sélection des portfolios dont le code contient 
				<code>2015_work</code>
				</li>
				<li><code>code*=portfolio_code</code> sélection des portfolios dont le code contient le 
				contenu de la variable <code>porfolio_code</code>
				</li>
			</ul>
		</li>
		<li>
			<code>Tri - tag sémantique</code> Tag sémantique du noeud sur lequel doit se faire le tri.
		</li>
		<li>
			<code>Tri - élément</code> Valeur possible pour le tri (libellé noeud, texte d'une ressource, 
			code d'un noeud ou valeur d'un item.)
		</li>
	</ul>
</article>

<article>
	<h3 id='for-each-portfolio-node'>ForEachPortfolioNode</h3>
	<p>Pour chacun des portfolios répondant au test de la sélection et des noeuds sélectionnés, 
		Karuta exécute les commandes qui se trouvent dans le <code>ForEachPortfolioNode</code>. 
		Cette commande évite de charger tout le portfolio comme le fait la commande précédente.
	</p>
	<p>Champs à renseigner&nbsp;:</p>
	<ul>
		<li>
			<code>Références à initialiser</code> Liste des variables (séparées par une barre oblique) à 
			réinitialiser pour chaque nouveau portfolio.
		</li>
		<li>
			<code>Sélection portfolios</code> Test Jquery permetant de sélectionner des portfolios parmi 
			ceux visibles par l'usager. Exemples :
			<ul>
				<li><code>code*='2015_work'</code> sélection des portfolios dont le code contient 
					<code>2015_work</code>
				</li>
				<li><code>code*=portfolio_code</code> sélection des portfolios dont le code contient le 
					contenu de la variable <code>porfolio_code</code>
				</li>
			</ul>
		</li>
		<li>
			<code>Tri - tag sémantique</code> Tag sémantique du noeud sur lequel doit se faire le tri.
		</li>
		<li>
			<code>Tri - élément</code> Valeur possible pour le tri (libellé noeud, texte d'une ressource, 
			code d'un noeud ou valeur d'un item).
		</li>
	</ul>
	<p><code>Tag sémantique</code> Tag sémantique du ou des noeuds à sélectionner dans le portfolio.</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='for-each-person'>ForEachPerson</h3>
	<p>Pour chacune des personnes répondant au test de la sélection, Karuta exécute les commandes qui 
		se trouvent dans le <code>ForEachPerson</code>.
	</p>
	<p>Champs à renseigner&nbsp;:</p>
	<ul>
		<li>
			<code>Références à initialiser</code> Liste des variables (séparées par une barre oblique) à 
			réinitialiser pour chaque nouvelle personne.
		</li>
		<li>
			<code>Sélection personnes</code> Test Jquery permetant de sélectionner les personnes du système. 
			Exemples :
			<ul>
				<li><code>username='olivier'</code> sélection de la personne dont le username est 
					<code>olivier</code>
				</li>
				<li><code>username=identifier</code> sélection de la personne dont le username est le contenu 
					de la variable <code>identifier</code>
				</li>
			</ul>
		</li>
	</ul>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='for-each-node'>ForEachNode</h3>
	<p>Pour chacun des éléments de portfolio répondant aux critères (type de noeud, tag sémantique et 
		test), Karuta exécute les commandes qui se trouvent dans le <code>ForEachNode</code>.
	</p>
	<p>Champs à renseigner&nbsp;:</p>
	<ul>
		<li>
			<code>Références à initialiser</code> Liste des variables (séparées par une barre oblique) à 
			réinitialiser pour chaque nouvel élément.
		</li>
		<li>
			<code>Type de noeud</code> Liste déroulante des choix possibles.
		</li>
		<li>
			<code>Tag sémantique</code> Tag sémantique des éléments à sélectionner.
		</li>
		<li>
			<code>Test</code> Test Jquery permettant de filtrer les éléments répondant aux deux critères 
			précédents. Les tests ci-dessous peuvent être combinés. Par exemple : 
			<code>.sort().first()</code> retournera le premier élément de la liste triée.
		</li>
	</ul>
	<p>Tests prédéfinis :</p>
	<ul>
		<li>
			<code>.sort()</code> trie la liste des noeuds résultats sur le libellé en ordre croissant
		</li>
		<li>
			<code>.invsort()</code> trie la liste des noeuds résultats sur le libellé en ordre décroissant
		</li>
		<li>
			<code>.filename_not_empty()</code> s'applique aux documents et vérifie un fichier a été uploadé
		</li>
		<li>
			<code>.url_not_empty()</code> s'applique aux urls et vérifie si un url a été enregistré
		</li>
		<li>
			<code>.text_not_empty()</code> s'applique aux textes couts et longs et vérifie si du texte 
			a été enregistré dans la ressource.
		</li>
	</ul>
	<p>Exemples de fonctions jQuery :</p>
	<ul>
		<li>
			<code>.first()</code> retourne le premier élément de la liste résultat</li>
		<li><code>.not(':eq(0)')</code> retourne la liste sauf le premier élément</li>
		<li><code>.last()</code> retourne le dernier élément de la liste résultat</li>
		<li><code>.has("code:contains('2')")</code> sélectionne les éléments dont le code contient un 2</li>
		<li>
			<code>.siblings().has("metadata[semantictag*=job-title]")</code> retourne la liste des éléments 
			de même niveau contenant le tag sémantique "job-title"
		</li>
		<li>
			<code>.has("metadata-wad[submitted='Y']").last()</code> retourne le dernier élément ayant été 
			soumis
		</li>
		<li>
			<code>.has("metadata-wad[private='N']").last()</code> retourne le dernier élément qui est visible
		</li>
		<li>
			<code>.has('asmContext:has("metadata[semantictag*=visibility-cv-short]"):has
			("code:contains(@1)")')</code> 
			retourne l'élément si il y a un enfant avec le tag sémantique "visibility-cv-short" et 
			dont le code contient "@1"
		</li>
		<li>
			<code>.sortElements(function(a, b){ return $("code",$("asmResource[xsi_type=Get_Resource]",a))
			.text() &gt; $("code",$("asmResource[xsi_type=Get_Resource]",b)).text() ? 1 : -1; })</code> 
			trie sur le code du Get_Resource
		</li>
	</ul>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='for-each-line'>ForEachLine</h3>
	<p>
		Pour chacune des lignes du fichier csv, Karuta exécute les commandes qui se trouvent dans le 
		<code>ForEachLine</code>.
	</p>
	<p>
		Pour la commande <code>ForEachPerson</code> dans l'attribut sélection de personnes la valeur 
		username=identifiant (sans guillemets), Karuta remplacera identifiant par la valeur de la variable 
		locale identifiant.
	</p>
	<p>
		Pour les commandes <code>ForEachPortfolio</code> et <code>ForEachPortfolioNode</code> dans 
		sélection portfolios si la valeur code=portfolio_code (sans guillemets), Karuta remplacera 
		portfolio_code par la valeur de la variable locale identifiant.
	</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='table'>Table</h3>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='row'>Row</h3>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='cell'>Cell</h3>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='cell'>Node</h3>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='aggregate'>Aggregate</h3>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='text'>Text</h3>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='url2unit'>URL2Unit</h3>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='svg'>SVG</h3>
	<p>
		La commande SVG initialise un dessin vectoriel SVG. Les commandes de dessin disponibles 
		permettent de construire des diagrammes en étoile comme illustrée ci-dessous.
	</p>
	<img src='../assets/img/web.png' width='60%'/>
	<p>Champs à renseigner&nbsp;:</p>
	<ul>
		<li><code>min-width</code> largeur minimum (par défaut 100%)</li>
		<li><code>min-height</code> hauteur minimum (par défaut 500px)</li>
	</ul>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='draw-web-title'>Draw Web Title</h3>
	<p>La commande affiche le titre du dessin SVG.</p>
	<p>Champs à renseigner&nbsp;:</p>
	<ul>
		<li><code>Type de noeud</code> Liste déroulante des choix possibles.</li>
		<li><code>Tag sémantique</code> Tag sémantique de l'élément à afficher.</li>
		<li><code>Afficher</code> Liste déroulante des choix possibles.</li>
	</ul>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='draw-web-axis'>Draw Web Axis</h3>
	<p>La commande trace un axe de l'étoile. Le libellé de l'axe est défini par les champs de la commande.</p>
	<p>Champs à renseigner&nbsp;:</p>
	<ul>
		<li><code>Référence</code> valeur utilisée pour les aggrégats.</li>
		<li><code>Type de noeud</code> Liste déroulante des choix possibles.</li>
		<li><code>Tag sémantique</code> Tag sémantique de l'élément à afficher.</li>
		<li><code>Afficher</code> Liste déroulante des choix possibles.</li>
	</ul>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='draw-web-line'>Draw Web Line</h3>
	<p>
		La commande positionne une valeur sur l'axe correspondant et trace une ligne entre la dernière 
		valeur et la valeur courante. La commande affiche également la légende.
	</p>
	<p>Champs à renseigner&nbsp;:</p>
	<ul>
		<li><code>Référence</code> valeur utilisée pour les aggrégats.</li>
		<li>
			<code>Valeur - Type de noeud</code> Liste déroulante des choix possibles pour la valeur à afficher.
		</li>
		<li><code>Valeur - Tag sémantique</code> Tag sémantique de l'élément à afficher.</li>
		<li><code>Valeur - Afficher</code> Liste déroulante des choix possibles pour le noeud sélectionné.</li>
		<li><code>Légende - Type de noeud</code> Liste déroulante des choix possibles pour la légende.</li>
		<li><code>Légende - Tag sémantique</code> Tag sémantique de l'élément à afficher.</p>
		<li><code>Légende - Afficher</code> Liste déroulante des choix possibles poour le noeud sélectionné.</li>
		<li>
			<code>Légende - Position</code> entier donnant la position relative de la légende 
			(par défaut 0 positionne la légende au plus)
		</li>
	</ul>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='show-sharing'>Show Sharing</h3>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='go-parent'>Go Parent</h3>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='qrcode'>QR Code</h3>
</article>

<h2 id='css'>Mise en forme</h2>

<h2 id='edition'>Édition</h2>

