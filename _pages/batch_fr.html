---
layout: archive
permalink: /batch_fr/
title: "Batch"
sidebar:
 nav: "batch_fr"
---
<!- =========================================== ->
<h3>Fonctionnement</h3>
<!- =========================================== ->

<p>Les commandes Batch permettent d'automatiser la création, modification et suppression de portfolios ainsi que la création ou suppresion d'usagers.</p>
<img src='../assets/img/execute-batch.png' width='80%'/>
<p>À partir d'un ou plusieurs modèles de portfolios, d'un script batch et d'un fichier CSV, KARUTA va créer les usagers et leurs portfolios associés.</p>
<p>Exemple de script</p>
<img src='../assets/img/batch-script.png'/>
<ul>
	<p>Pour chaque ligne</p>
	<li>Créer un usager si il n'existe pas</li>
	<li>Créer un portfolio profil</li>
	<li>Partager le portfolio profil avec le rôle student</li>
	<li>Mettre à jour les champs nom et prénon dans le profil</li>
	<li>Créer un portfolio d'évaluation</li>
	<li>Partager le portfolio d'évaluation avec le rôle student</li>
	<li>Mettre à jour le Proxy du portfolio d'évaluation vers le portfolio profil</li>
</ul>
<p>Exemple de fichier CSV</p>
<img src='../assets/img/csv-file.png'/>
<p>Le fichier contient les informations nécessaires à l'éxécution du batch.</p>
<!- =========================================== ->
<h3>Structure du fichier CSV</h3>
<!- =========================================== ->
<p><code>Ligne 1 : </code> Ce sont les noms des variables 'globales', c'est à dire les variables qui ont les même valeurs pour toutes les lignes. <code>model_code</code> est un nom réservé. C'est le code du batch à exécuter. Dans le batch les références au variables globales seront précédées de <code>//</code></p>
<p><code>Ligne 2 : </code> Ce sont respectivement les valeurs des variables globales. Dans l'exemple présenté la valeur de model_code est createStudents</p>
<p><code>Ligne 3 : </code> Ce sont les noms des variables 'locales', c'est à dire les variables qui ont des valeurs différentes pour chaque ligne.</p>
<p><code>Ligne 4 et +  : </code> Ce sont respectivement les valeurs des variables locales.</p>

<!- =========================================== ->
<h3>Commandes</h3>
<!- =========================================== ->
Les commandes disponibles sont :
<ul>
	<li><a href='#for-each-line'><code>ForEachLine</code></a></li>
</ul>
<h4>Commandes pour les usagers</h4>
<ul>
	<li><a href='#create-person'><code>CreatePerson</code></a></li>
	<li><a href='#delete-person'><code>DeletePerson</code></a></li>
	<li><a href='#join-usergroup'><code>JoinUserGroup</code></a></li>
	<li><a href='#leave-usergroup'><code>LeaveUserGroup</code></a></li>
</ul>
<h4>Commandes pour les portfolios</h4>
<ul>
	<li><a href='#create-tree'><code>CreateTree</code></a></li>
	<li><a href='#share-tree'><code>ShareTree</code></a></li>
	<li><a href='#unshare-tree'><code>UnshareTree</code></a></li>
	<li><a href='#select-tree'><code>SelectTree</code></a></li>
	<li><a href='#delete-tree'><code>DeleteTree</code></a></li>
</ul>
<h4>Commandes pour les groupes de portfolios</h4>
<ul>
	<li><a href='#join-portfoliogroup'><code>JoinPortfolioGroup</code></a></li>
</ul>
<h4>Commandes pour le partage/départage avec des groupes d'usagers</h4>
<ul>
	<li><a href='#share-usergroup'><code>ShareUserGroup</code></a></li>
	<li><a href='#unshare-usergroup'><code>UnshareUserGroup</code></li>
</ul>
<h4>Commandes pour ajout dans portfolios</h4>
<ul>
	<li><a href='#import-node'><code>ImportNode</code></a></li>
	<li><a href='#move-up'><code>MoveUp</code></a></li>
</ul>
<h4>Commandes de mise à jour d'éléments</h4>
<ul>
	<li><a href='#update-field'><code>UpdateField</code></a></li>
	<li><a href='#update-proxy'><code>UpdateProxy</code></a></li>
	<li><a href='#update-dashboard'><code>UpdateDashboard</code></a></li>
	<li><a href='#update-treeroot'><code>UpdateTreeRoot</code></a></li>
</ul>
<h4>Commandes de mise à jour des métadonnées</h4>
<ul>
	<li><a href='#update-metadata-query'><code>UpdateMetadataQuery</code></a></li>
	<li><a href='#update-metadata-menu'><code>UpdateMetadataMenu</code></a></li>
	<li><a href='#update-metadata-inline'><code>UpdateMetadataInline</code></a></li>
	<li><a href='#update-metadata'><code>UpdateMetadata</code></a></li>
	<li><a href='#update-metadata-wad'><code>UpdateMetadataWad</code></li>
</ul>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='for-each-line'>ForEachLine</h3>
	<p>ForEachLine est une boucle. Les commandes du ForEachLine seront exécutées pour chaque ligne du Fichier CSV.</p>
</article>


<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='create-person'>CreatePerson</h3>
	<p>La commande crée un usager avec les informations fournies dans les champs de la commande.</p>
	<h4>Champs</h4>
	<p><code>Identifiant</code></p>
	<p><code>Prénom</code></p>
	<p><code>Nom</code></p>
	<p><code>Courriel</code></p>
	<p><code>Mot de passe</code></p>
	<p><code>Créateur?</code></p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='delete-person'>DeletePerson</h3>
	<p>La commande permet de supprimer un usager</p>
	<h4>Champ</h4>
	<p><code>Identifiant</code></p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='join-usergroup'>JoinUserGroup</h3>
	<p>La commande permet de mettre un usager daans un groupe d'usager</p>
	<h4>Champs</h4>
	<p><code>Personne</code> Il faut ajouter un select pour une variable ou value pour spécifier directement une valeur</p>
	<p><code>Groupe</code> Il faut ajouter un select pour une variable ou value pour spécifier directement une valeur</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='leave-usergroup'>LeaveUserGroup</h3>
	<p></p>
	<h4>Champs</h4>
	<p><code>Personne</code> Il faut ajouter un select pour une variable ou value pour spécifier directement une valeur</p>
	<p><code>Groupe</code> Il faut ajouter un select pour une variable ou value pour spécifier directement une valeur</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='create-tree'>CreateTree</h3>
	<p>La commande permet de créer un portfolio à partir d'un modèle de portfolio et de précider le code et le libellé du portfolio qui sera créé.</p>
	<h4>Champs</h4>
	<p><code>ID</code>l'ID est utilisé, dans les commandes nécessitant la sélection d'un arbre, pour faire référence à ce portfolio, par exemple, pour le partager avec un usager.</p>
	<p><code>Modèle</code> Il faut ajouter un <i>select</i> pour une variable et/ou <i>value</i> pour spécifier directement une valeur</p>
	<p><code>Code</code> Il faut ajouter un <i>select</i> pour une variable et/ou <i>value</i> pour spécifier directement une valeur</p>
	<p><code>Libellé</code> Il faut ajouter un <i>select</i> pour une variable et/ou <i>value</i> pour spécifier directement une valeur</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='share-tree'>ShareTree</h3>
	<p>La commande permet de partager un portfolio avec un usager dans un rôle donné.</p>
	<h4>Champs</h4>
	<p><code>Sélection arbre</code> permet de sélectionner l'id du portfolio concerné par le partage.</p>
	<p><code>Personne</code> Il faut ajouter un select pour une variable ou value pour spécifier directement une valeur</p>
	<p><code>Rôle</code> Il faut ajouter un select pour une variable ou value pour spécifier directement une valeur</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='select-tree'>SelectTree</h3>
	<p>La commande permet de sélectionner un portfolio qui sera référencé dans d'autres commandes.</p>
	<h4>Champ</h4>
	<p><code>Code</code> Il faut ajouter un <i>select</i> pour une variable et/ou <i>value</i> pour spécifier directement une valeur</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='delete-tree'>DeleteTree</h3>
	<p>La commande permet de supprimer un portfolio.</p>
	<h4>Champ</h4>
	<p><code>Code</code> Il faut ajouter un <i>select</i> pour une variable et/ou <i>value</i> pour spécifier directement une valeur</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='join-portfoliogroup'>JoinPortfolioGroup</h3>
	<p>La commande permet d'ajouter un portfolio à un groupe de portfolios.</p>
	<h4>Champs</h4>
	<p><code>Sélection arbre</code> permet de sélectionner l'id du portfolio concerné par le partage.</p>
	<p><code>Groupe</code> Il faut ajouter un select pour une variable ou value pour spécifier directement une valeur</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='share-usergroup'>ShareUserGroup</h3>
	<p>La commande permet de partager un portfolio avec un groupe d'usagers avec un rôle donné.</p>
	<h4>Champs</h4>
	<p><code>Sélection arbre</code> permet de sélectionner l'id du portfolio concerné par le partage.</p>
	<p><code>Groupe</code> Il faut ajouter un select pour une variable ou value pour spécifier directement une valeur</p>
	<p><code>Rôle</code> Il faut ajouter un select pour une variable ou value pour spécifier directement une valeur</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='unshare-usergroup'>UnshareUserGroup</h3>
	<p>La commande permet de partager un portfolio avec un groupe d'usagers avec un rôle donné.</p>
	<h4>Champs</h4>
	<p><code>Sélection arbre</code> permet de sélectionner l'id du portfolio concerné par le partage.</p>
	<p><code>Groupe</code> Il faut ajouter un select pour une variable ou value pour spécifier directement une valeur</p>
	<p><code>Rôle</code> Il faut ajouter un select pour une variable ou value pour spécifier directement une valeur</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='import-node'>ImportNode</h3>
	<p>La commande permet d'importer un ou des éléments dans un portfolio.</p>
	<h4>Champs</h4>
	<p><code>Sélection destination</code> C'est la section, page ou sous-section dans laquelle on veut importer. Format : ID.tag_sémantique. ID est une rérence à un portfolio créé ou sélectionné précedemment.</p>
	<p><code>Sélection source</code> C'est la partie que l'on veut importer dans le portfolio. Format : code_portfolio.tag_sémantique.</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='move-up'>MoveUp</h3>
	<p>La commande permet d'importer un ou des éléments dans un portfolio.</p>
	<h4>Champ</h4>
	<p><code>Sélection</code> C'est le noeud que l'on veut déplacer. Format : ID.tag_sémantique. ID est une rérence à un portfolio créé ou sélectionné précedemment.</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='update-field'>UpdateField</h3>
	<p>La commande permet de mettre à jour un champ de type texte court.</p>
	<h4>Champs</h4>
	<p><code>Sélection</code> C'est le noeud que l'on veut mettre à jour. Format : ID.tag_sémantique. ID est une rérence à un portfolio créé ou sélectionné précedemment.</p>
	<p><code>Valeur du champ</code> Cela peut-être soit une valeur (value) et/ou une variable (select) soit une référence à un noeud source (SourceSelect - Format : code_portfolio.tag_sémantique)</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='update-proxy'>UpdateProxy</h3>
	<p>La commande permet de mettre à jour un proxy.</p>
	<h4>Champs</h4>
	<p><code>Sélection proxy</code> C'est le noeud proxy que l'on veut mettre à jour. Format : ID.tag_sémantique. ID est une rérence à un portfolio créé ou sélectionné précedemment.</p>
	<p><code>Sélection source</code> C'est le noeud vers lequel pointe le proxy. Format : code_portfolio.tag_sémantique.</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='update-dashboard'>UpdateDashboard</h3>
	<p>La commande permet de mettre à jour l'uuid d'un tableau de bord.</p>
	<h4>Champs</h4>
	<p><code>Sélection</code> C'est le noeud proxy que l'on veut mettre à jour. Format : ID.tag_sémantique. ID est une rérence à un portfolio créé ou sélectionné précedemment.</p>
	<p><code>Dashboard uuid</code> Cela peut-être soit une valeur (value) et/ou une variable (select) soit une référence à un noeud source (SourceSelect - Format : ID.UUDI où ID est une réfrence à un portfolio déjà créé ou sélectionné et UUID est un mot réservé. La valeur est alors l'uuid du porfolio ID)</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='update-treeroot'>UpdateTreeRoot</h3>
	<p>La commande permet de mettre à jour le code et le libellé d'un portfolio.</p>
	<h4>Champs</h4>
	<p><code>Ancien code</code> Il faut ajouter un <i>select</i> pour une variable et/ou <i>value</i> pour spécifier directement une valeur</p>
	<p><code>Nouveau code</code> Il faut ajouter un <i>select</i> pour une variable et/ou <i>value</i> pour spécifier directement une valeur</p>
	<p><code>Libellé</code> Il faut ajouter un <i>select</i> pour une variable et/ou <i>value</i> pour spécifier directement une valeur</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='update-metadata-query'>UpdateMetadataQuery</h3>
	<p>La commande permet de mettre à jour l'attribut recherche (query) d'un noeud.</p>
	<h4>Champs</h4>
	<p><code>Sélection</code> C'est le noeud que l'on veut mettre à jour. Format : ID.tag_sémantique. ID est une rérence à un portfolio créé ou sélectionné précedemment.</p>
	<p><code>Valeur query</code> Il faut ajouter un <i>select</i> pour une variable et/ou <i>value</i> pour spécifier directement une valeur</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='update-metadata-menu'>UpdateMetadataMenu</h3>
	<p>La commande permet de mettre à jour l'attribut menu d'un noeud.</p>
	<h4>Champs</h4>
	<p><code>Sélection</code> C'est le noeud que l'on veut mettre à jour. Format : ID.tag_sémantique. ID est une rérence à un portfolio créé ou sélectionné précedemment.</p>
	<p><code>Valeur menu</code> Il faut ajouter un <i>select</i> pour une variable et/ou <i>value</i> pour spécifier directement une valeur</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='update-metadata-inline'>UpdateMetadataInline</h3>
	<p>La commande permet de mettre à jour l'attribut édition en ligne (inline) d'un noeud.</p>
	<h4>Champs</h4>
	<p><code>Sélection</code> C'est le noeud que l'on veut mettre à jour. Format : ID.tag_sémantique. ID est une rérence à un portfolio créé ou sélectionné précedemment.</p>
	<p><code>Valeur inline (Y ou N)</code> Il faut ajouter un <i>select</i> pour une variable et/ou <i>value</i> pour spécifier directement une valeur</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='update-metadata'>UpdateMetadata/h3>
	<p>La commande est plus générale que les précédentes et permet de mettre à jour n'importe quel attribut de metadata d'un noeud.</p>
	<h4>Champs</h4>
	<p><code>Sélection</code> C'est le noeud que l'on veut mettre à jour. Format : ID.tag_sémantique. ID est une rérence à un portfolio créé ou sélectionné précedemment.</p>
	<p><code>attribut</code> C'est le nom de l'attibut à mettre à jour.
	<p><code>Valeur atttribut</code> Il faut ajouter un <i>select</i> pour une variable et/ou <i>value</i> pour spécifier directement une valeur</p>
</article>

<article>
	<a style='float:right' href='#top'><img src='../assets/img/arrow-up.png'/></a>
	<h3 id='update-metadata-wad'>UpdateMetadataWad</h3>
	<p>La commande est plus générale que les précédentes et permet de mettre à jour n'importe quel attribut de metadataWad d'un noeud.</p>
	<h4>Champs</h4>
	<p><code>Sélection</code> C'est le noeud que l'on veut mettre à jour. Format : ID.tag_sémantique. ID est une rérence à un portfolio créé ou sélectionné précedemment.</p>
	<p><code>attribut</code> C'est le nom de l'attibut à mettre à jour.
	<p><code>Valeur atttribut</code> Il faut ajouter un <i>select</i> pour une variable et/ou <i>value</i> pour spécifier directement une valeur</p>
</article>

